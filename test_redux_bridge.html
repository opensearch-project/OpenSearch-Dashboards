<!DOCTYPE html>
<html>
<head>
    <title>Redux Bridge Test</title>
</head>
<body>
    <h1>Redux Bridge Client Test</h1>
    <p>Open browser console and check for Redux Bridge Client logs</p>
    
    <script>
        console.log('ðŸ§ª TEST: Starting Redux Bridge Client test...');
        
        // Check if Redux Bridge Client is available
        setTimeout(() => {
            console.log('ðŸ§ª TEST: Checking window.reduxBridgeClient...');
            console.log('ðŸ§ª TEST: window.reduxBridgeClient =', window.reduxBridgeClient);
            
            // Check if global services are available
            console.log('ðŸ§ª TEST: window.exploreServices =', window.exploreServices);
            
            if (window.exploreServices && window.exploreServices.store) {
                console.log('ðŸ§ª TEST: Redux store is available!');
                try {
                    const state = window.exploreServices.store.getState();
                    console.log('ðŸ§ª TEST: Current query state:', {
                        query: state.query?.query,
                        language: state.query?.language,
                        dataset: state.query?.dataset?.title
                    });
                } catch (error) {
                    console.error('ðŸ§ª TEST: Error accessing Redux state:', error);
                }
            } else {
                console.log('ðŸ§ª TEST: Redux store not available yet');
            }
        }, 2000);
        
        // Test manual HTTP request to Redux bridge
        setTimeout(() => {
            console.log('ðŸ§ª TEST: Testing manual HTTP request to Redux bridge...');
            
            fetch('/api/osd-mcp-server/redux/update-query', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'osd-xsrf': 'true'
                },
                body: JSON.stringify({
                    query: 'source = test_manual_request | head 3',
                    language: 'PPL'
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('ðŸ§ª TEST: Manual HTTP request response:', data);
            })
            .catch(error => {
                console.error('ðŸ§ª TEST: Manual HTTP request error:', error);
            });
        }, 5000);
    </script>
</body>
</html>